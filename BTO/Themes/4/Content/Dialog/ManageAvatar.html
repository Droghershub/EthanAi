<div id="updateProfilePictures" class="modal fade" role="dialog" style="overflow-y:scroll">
    <div class="modal-dialog">
        <div class="modal-content">            
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">×</button>
                    <h5 class="modal-title">{{$root.translateData["Update Picture"]}}</h5>
                </div>
                <div class="modal-body">
                    <form name="form_profile_picutes" novalidate  role="form">
                        <div class="panel panel-info">
                            <div class="panel-body">
                                <div class="row highlight">
                                    <div class="col-sm-4" style="text-align:center">                                        
                                        <img id="imgAvatarPicture" class="img" ng-src="{{$root.Avatar.src}}">                                        
                                        <button type="button" class="btn btn-xs btn-primary waves-effect waves-light btn-white" ng-click="$root.manageAvatarService.editThumbnail()">{{$root.translateData["Edit Thumbnail"]}}</button>
                                        <input type="file" name="filesToUploadPicture" id="filesToUploadPicture" onchange="encodeImage1(event);" class="hidden" accept="image/*" />
                                        <input type="hidden" ng-model="Avatar.canSave" id="canSave" />
                                    </div>
                                    <div class="col-md-5">
                                        <a class="btn waves-effect btn-white" onclick="$('#filesToUploadPicture').click();">
                                            {{$root.translateData["UPLOAD PHOTO"]}}
                                        </a>
                                    </div>
                                </div> 
                                <div class="row" ng-if="$root.imageCollections != null && $root.imageCollections.length > 0">
                                    <div class="col-lg-12">
                                        <h5 class="page-header">{{$root.translateData["Suggested Photos"]}}</h5>
                                    </div>
                                    <div class="col-md-12" style="height:500px; overflow-y:scroll">
                                        <div ng-repeat="imageItem in $root.imageCollections" class="thumb" style="float:left">
                                            <a class="thumbnail" ng-click="$root.manageAvatarService.select(imageItem.id)">
                                                <img class="img-responsive" style=" height:150px !important;" ng-src="{{imageItem.url}}" src="" alt="" />
                                            </a>                                            
                                            <button type="button" class="btn btn-xs btn-danger waves-effect waves-light btn-white" ng-click="$root.manageAvatarService.delete(imageItem.id)">Delete</button>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal" id="cancelUpdateProfile">{{$root.translateData["Cancel"]}}</button>
                    <button ng-disabled="form_profile_picutes.$invalid" type="button" class="btn btn-primary" id="OkUpdateProfile" ng-click="$root.manageAvatarService.saveChangeUpdatePicture();">{{$root.translateData["Save"]}}</button>
                </div>            
        </div>
    </div>
</div>
<script type="text/javascript">

    function encodeImage1(event) {
        var target = $('#filesToUploadPicture');
        var filesSelected = document.getElementById("filesToUploadPicture").files;
        if (filesSelected.length > 0) {
            var fileToLoad = filesSelected[0];
            angular.element(document.body).injector().get('manageAvatarService').encodeImage(fileToLoad);
        }
        target.wrap('<form>').closest('form').get(0).reset();
        target.unwrap();
    }    
</script>


<div id="cropProfilePictures" class="modal fade" role="dialog" style="overflow-y:scroll">
    <div class="modal-dialog">
        <div class="modal-content">            
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">×</button>
                    <h5 class="modal-title">{{$root.translateData["Update Picture"]}}</h5>
                </div>
                <div class="modal-body">
                    <div id="cropArea" class="row cropArea" style="text-align:center;margin: 0 auto; ">
                        <img-crop image="$root.myImage" result-image="$root.myCroppedImage" change-on-fly="true"></img-crop>
                    </div>
                    <div class="row" style="text-align:center;">
                        <div style="text-align:center;">{{$root.translateData["Cropped Image"]}}:</div>
                        <div style="text-align:center;"><img id="cropedImage" ng-src="{{myCroppedImage}}" style="border-radius: 50%;" /></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal" id="cancelUpdateProfile">{{$root.translateData["Cancel"]}}</button>
                    <button ng-disabled="form_profile_picutes.$invalid" type="button" class="btn btn-primary" id="OkUpdateProfile" ng-click="$root.manageAvatarService.saveCropPicture();">{{$root.translateData["Save"]}}</button>
                </div>            
        </div>
    </div>
</div>
<script type="text/javascript">
    var handleFileSelect = function (evt) {
        var file = evt.currentTarget.files[0];
        var reader = new FileReader();
        reader.onload = function (evt) {
            $scope.$apply(function ($scope) {
                $scope.myImage = evt.target.result;
            });
        };
        reader.readAsDataURL(file);
    };
    angular.element(document.querySelector('#fileInput')).on('change', handleFileSelect);

</script>